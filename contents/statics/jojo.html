<html>
<head>
    <title>タイピングオラオラッシュ</title>
    <meta charset="UTF-8" />
    <script type="text/javascript" src="//code.jquery.com/jquery-1.10.2.min.js"></script>
    <script type="text/javascript">
        // namespace
        window.app = {};
        app.input=[];
        app.counter = 0;
        $(function(){
            var $body  = $('body');
            var $start = $('#start');
            var $ora   = $('#ora');

            $start.on('click', function(){
                $('body').css({"background-color":"#1f1f1f","color":"#f5f5f5", "cursor": "wait"});
                var count=5;
                var timer;
                var game = function(){
                    if(count===0){
                        clearInterval(timer);
                        $body.css({"background-color":"#f5f5f5","color":"#1f1f1f", "cursor": "default"});
                        $start.html('');
                        app.begin = new Date();
                        $body.on('keypress', function( event ) {
                            // keycode map
                            if( event.which === 111 ){
                                app.input.push('o');
                            }else if(event.which === 114){
                                app.input.push('r');
                            }else if(event.which === 97){
                                if(app.input[1]==='r' && app.input[0]==='o'){
                                    app.counter = app.counter+1;
                                    $ora.append("オラ ");
                                    if(app.counter == 15){
                                        $ora.empty().css({"font-size":"3.5em"}).append("オラァ");
                                        $body.off('keypress');
                                        app.end = new Date();
                                        setTimeout(function(){
                                            var time = app.end.getTime() - app.begin.getTime();
                                            console.log(time);
                                            $('#ora').fadeOut('slow', function(){
                                                $('#end').append('TIME: ' + time.toString() + 'ミリ秒');
                                                $('#tw').attr('data-text', 'グッド！なかなかおもしろいゲームだ。：' + time.toString() + 'ミリ秒');
                                            });
                                        }, 500);
                                    }
                                }
                                app.input=[];
                            }
                        });
                    } else {
                        $start.html(count);
                    }
                    count--;
                };
                timer = setInterval(game, 1000);
            });

        });
    </script>
    <link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Goblin+One' rel='stylesheet' type='text/css'>
    <style type="text/css">
        body{
            background-color: #f5f5f5;
            font-size: 1.0em;
            margin: 0;
            color: #1f1f1f;
        }
        header{
            margin: 0;
        }
        ul{
            margin: 0;
        }
        footer{
            position: absolute;
            bottom: 15px;
            right: 30px;
        }
        #head{
            width: 80%;
            margin-left:10%;
            padding: 10px;
            font-family: 'Lato', serif;
        }
        #rule{
            padding: 14px;
            width: 30em;
            border: 1px solid rgba(0,0,0,0.4);
        }
        .content{
            width: 90%;
            height: 450px;
            margin-left: 5%;
            font-family: 'Goblin One', cursive;
            font-size: 6em;
        }
        #start, #end{
            width: 100%;
            text-align: center;
        }
        .strong {
            font-weight: bold;
        }
        #ora{
            font-family:"メイリオ", Meiryo,  "ヒラギノ角ゴ Pro W3", "Hiragino Kaku Gothic Pro",Osaka, "ＭＳ Ｐゴシック", "MS PGothic", sans-serif;
            font-size: 1.0em;
            font-weight: bold;
            text-align: center;
        }

    </style>

</head>
<body>

<header>
    <div id="head">
        <div id="rule">
            <span class="strong">ルール:</span>
            <ul>
                <li>The Worldをクリックして時を止める</li>
                <li>時がうごきだしたら「ora」をできるだけ早くタイピング</li>
                <li>15回「オラ」したら終了、タイムが表示される</li>
                <li>タイピングする者が持つスタンドの能力の使用は許可する</li>
                <li>やれやれ、Google Chromeしか動作確認してねーぜッ！</li>
            </ul>

        </div>
    </div>

</header>

<div class="content">
    <div id="start">The World</div>
    <div id="ora"></div>
    <div id="end"></div>
</div>
<footer>
    <a id="tw" href="https://twitter.com/share" class="twitter-share-button" data-related="shoota" data-hashtags="adventar,jojohtml" data-text="">Tweet</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
    
</footer>
<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-45958410-1', 'anaguma.org');
    ga('send', 'pageview');
</script>
</body>
</html>